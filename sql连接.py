# -*- coding: utf-8 -*-
"""
Created on Wed Nov 30 15:00:39 2022

@author: guo
"""
import pymysql

equipment = {
            '201':'10.141.1.10',
            '202':'10.141.2.10',
            '203':'10.141.3.10',
            '204':'10.141.4.10',
            '205':'10.141.5.10',
            '206':'10.141.6.10',
            '207':'10.141.7.10',
            '208':'10.141.8.10',
            '209':'10.141.9.10',
            '210':'10.141.10.10',
            '211':'10.141.11.10',
            '212':'10.141.12.10',
            '213':'10.141.13.10',
            '214':'10.141.14.10',
            '215':'10.141.15.10',
            '216':'10.141.16.10',
            '217':'10.141.17.10',
            '218':'10.141.18.10',
            '219':'10.141.19.10',
            '220':'10.141.20.10',
            '221':'10.141.21.10',
            '222':'10.141.22.10',
            '223':'10.141.23.10',
            '224':'10.141.24.10',
            '226':'10.141.26.10',
            '228':'10.141.28.10',
            '230':'10.141.30.10',
            '233':'10.141.33.10',
            '236':'10.141.36.10',
            '239':'10.141.39.10',
            '240':'10.141.40.10',
            '241':'10.141.41.10',
            '242':'10.141.42.10',
            '244':'10.141.44.10',
            '245':'10.141.45.10',
            '247':'10.141.47.10',
            '248':'10.141.48.10'
            }

def query_mysql(host, sql, row=None, col= None):
    conn = pymysql.connect(host, user='root', passwd= 'MATRIX@501' )
    cur = conn.cursor()
    cur.execute(sql)
    data = cur.fetchone()
    cur.close()
    conn.close()
    if data != None:
        print('%s有数据' %host)
    
if __name__=='__main__':
    sql = 'SELECT * FROM icrane.perc WHERE DATE = (select CURRENT_DATE())'
    for host,val in equipment.items():
        query_mysql(host, sql, row=None, col= None)
        